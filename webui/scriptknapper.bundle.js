!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.scriptknapper=e():t.scriptknapper=e()}(self,(function(){return(()=>{"use strict";var t={212:(t,e,r)=>{r.r(e);const n=function(t,e="",r=""){let n="TRANSPILATION ERROR\n\nError while transpiling script from provided JSON:\n\n";return n+=t+"\n\n",""!==e&&(n+="Error occurred in the following template: "+e,n+=""===r?"\n\n":"\n"),""!==r&&(n+="Error occurred with the following markup data: "+r,n+="\n\n"),n+="Please correct these issues with the provided JSON, and then try again.",n},a=function(t,e){try{if(!t.hasOwnProperty("template"))throw"The given template call has not been given a template property.";let r=t.template,n=e.filter((t=>t.name===r));if(0===n.length)throw"The given template name ("+r+") is not recognised.";if(n.length>1)throw"The given template name ("+r+") has more than one match.";if(t.hasOwnProperty("data")&&!Array.isArray(t.data))throw"The provided data to the "+t.template+" template is not in an array."}catch(t){return[!0,n("Encountered a problem parsing the provided markup JSON: "+t)]}return[!1,""]},o=function(t){let e={};for(let r=0;r<t.length;r++)e={...t[r],...e};return e},i=function(t,e="{",r="}"){if(!t.startsWith(e))return-1;let n=0,a=0;for(;a<t.length;){if(t.substr(a,e.length)==e)n++;else if(t.substr(a,r.length)==r&&(n--,0===n))return a+r.length;a++}return-1},l=function(t,e){let r,n="ScriptKnapper encountered an issue when attempting to add data from a template to the data object: ",a=e;for(;a.includes("{+");){r=a.indexOf("{+");let e,l=i(a.substring(r,a.length),"{+","+}");if(l<0)return[!0,n+"Data addition tag was not properly closed."];try{e=JSON.parse("{"+a.substring(r+2,r+l-2)+"}")}catch(t){return[!0,n+t]}t=o([e,t]),a=a.substring(r+l,a.length)}return[!1,t]},s=function(t){let e,r;for(;t.includes("{+");){if(e=t.indexOf("{+"),r=i(t.substring(e,t.length),"{+","+}"),r<0)return[!0,"ScriptKnapper encountered an issue when attempting to add data from a template to the data object: Data addition tag was not properly closed."];t=t.substring(0,e)+t.substring(e+r)}return[!1,t]},p=function(t,e,r){let a,o,l=r,s=!1,p=0;for(;l.substring(p).includes("{:");){o=p+l.substring(p).indexOf("{:");try{let e;if(a="ScriptKnapper encountered an issue when attempting to resolve a call to the requested data: ","{"===l.charAt(o-1)){if(e=i(l.substring(o-1),"{{:",":}}"),-1===e)throw"Encountered an incorrectly formatted call to a template.";p=o+e}else{if(e=i(l.substring(o),"{:",":}"),-1===e)throw"Encountered an incomplete call to a data property.";let r=l.substring(o+2,o+e-2).trim();if(!t.hasOwnProperty(r))throw"Encountered a call to a property ("+r+") that hasn't been passed to the template.";if("string"!=typeof t[r])throw"Encountered a call to a property ("+r+") that did not contain a string.";l=l.substring(0,o)+t[r]+l.substring(o+e)}}catch(r){l=n(a+r,e,JSON.stringify(t)),s=!0;break}}return[s,l]},d=function(t,e,r){let a,l,s="Error handling embedded template call: ";for(;(a=t.indexOf("{{:"))>-1;){if(l=i(t.substring(a),"{{:",":}}"),-1===l)return[!0,n(s+"Embedded template object is invalid or incomplete.","Unable to determine the template called within an embedded template call.",JSON.stringify(e))];{let i;try{i=JSON.parse("{"+t.substring(a+3,a+l-3)+"}")}catch(t){return[!0,n(s+"Embedded template object is invalid.","Unable to determine the template called within an embedded template call.",JSON.stringify(e))]}let p={template:i.template,data:[]};for(let t=0;t<i.data.length;t++)p.data[t]=o([i.data[t],e]);let[d,f]=u([p],r);if(d)return[!0,f];t=t.substring(0,a)+f+t.substring(a+l)}}return[!1,t]},f=function(t,e,r){let a="",o="No data JSON is available for this exception.",i="Error when attempting to feed data into a template: ";try{for(let n=0;n<e.data.length;n++){o=JSON.stringify([e.data[n]]);let[f,u]=l(e.data[n],t.template);if(f)return[!0,u];e.data[n]=u;let[c,m]=s(t.template);if(c)return[!0,m];let[h,g]=p(e.data[n],t.name,m);if(h)return[!0,g];i="Encountered a problem parsing a call to an embedded template: ";const[b,y]=d(g,e.data[n],r);if(b)return[!0,y];a+=y}}catch(e){return[!0,n(i+e,t.name,o)]}return[!1,a]},u=function(t,e){let r,o,i="",l="";try{for(let n=0;n<t.length;n++){let[s,p]=a(t[n],e);if(s)return[!0,p];o=e.filter((e=>e.name===t[n].template))[0],l=o.name,r=t[n].data,t[n].hasOwnProperty("data")&&0!==t[n].data.length||(t[n].data=[{}]);let[d,u]=f(o,t[n],e);if(d)return[!0,u];i+=u}}catch(t){return[!0,n("Error when generating a markup object's instructions: "+t,l,JSON.stringify(r))]}return[!1,i]},c=function(t,e){let r;for(let n=0;n<e.length;n++){const a=e[n].from.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");r=new RegExp(a,"gi"),t=t.replace(r,e[n].to)}return t};(t=r.hmd(t)).exports={scriptKnapperMain:function(t,e){let r,a,o,i="";try{r="Encountered a problem parsing the provided template JSON: ",o=JSON.parse(e),r="Encountered a problem parsing the provided markup JSON: ",a=JSON.parse(t);let[n,l]=u(a,o);if(n)return[!0,l];i=l}catch(t){return[!0,n(r+t,"No template name is available for this error.","No data JSON is available for this error.")]}return i=c(i,[{from:"@ohb:",to:"{:"},{from:"@chb:",to:":}"},{from:"@odhb:",to:"{{:"},{from:"@cdhb:",to:":}}"},{from:"@ohb+",to:"{+"},{from:"@chb+",to:"+}"}]),[!1,i]},prepareTemplateString:function(t,e="none",r=!1,n=!1){let a=[];return"none"!==e&&("remove"===e?a.push({from:"\t",to:""},{from:"\v",to:""},{from:"\r",to:""},{from:"\n",to:""}):"spaceReplace"===e?a.push({from:"\t",to:" "},{from:"\v",to:" "},{from:"\r",to:" "},{from:"\n",to:" "}):"escapeCodeReplace"===e&&a.push({from:"\t",to:String.raw`\t`},{from:"\v",to:String.raw`\v`},{from:"\r",to:String.raw`\r`},{from:"\n",to:String.raw`\n`})),r&&a.push({from:'"',to:String.raw`\"`}),n&&a.push({from:"{{:",to:"@odhb:"},{from:":}}",to:"@cdhb:"},{from:"{:",to:"@ohb:"},{from:":}",to:"@chb:"},{from:"{+",to:"@ohb+"},{from:"+}",to:"@chb+"}),c(t,a)},buildTemplateJSON:function(t,e=!1){let r="[";return t.forEach((t=>{let n=t.template;e||(n=c(n,[{from:"\t",to:String.raw`\t`},{from:"\v",to:String.raw`\v`},{from:"\r",to:String.raw`\r`},{from:"\n",to:String.raw`\n`},{from:'"',to:String.raw`\"`}])),"}"===r.charAt(r.length-1)&&(r+=","),r+='\n\t{ "name": "'+t.templateName+'", "template": "'+n+'" }'})),r+"\n]"}}}},e={};function r(n){var a=e[n];if(void 0!==a)return a.exports;var o=e[n]={id:n,loaded:!1,exports:{}};return t[n](o,o.exports,r),o.loaded=!0,o.exports}return r.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(212)})()}));